<div class="view-common" ng-controller="VirtualMachineCrtl">
    <div class="le-row operate-panel">
        <div class="le-col-6 le-btn-group">
            <button class="btn btn-le-blue" ng-click="openVmCreateModal('720')"><span>创建云主机</span></button>
            <button class="btn btn-le-blueGreen" ng-click="startVm('400')"><span>启动</span></button>
            <button class="btn btn-le-green" ng-click="stopVm('400')"><span>停止</span></button>
            <div dropdown class="more-operation-dropdown">
                <a href class="btn btn-le-yellow" dropdown-toggle>
                    更多操作
                </a>
                <ul class="dropdown-menu" aria-labelledby="simple-dropdown">
                    <li><a href="javascript:void(0);" ng-click="deleteVm('400')">删除云主机</a></li>
                    <li><a href="javascript:void(0);">重启云主机</a></li>
                    <li><a href="javascript:void(0);">绑定云硬盘</a></li>
                </ul>
            </div>
        </div>
        <div class="le-col-6">
            <div class="le-search-box pull-right">
                <input type="text" ng-model="searchVmName" ng-change="doSearch()"/>
                <span class="search-icon"></span>
            </div>
        </div>
    </div>
    <div class="le-row list-common">
        <div class="le-col-12">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>
                         <span class="iconfont icon-righticon"  ng-class="{checked:isAllVmChecked()}" ng-click="checkAllVm()"></span>
                    </th>
                    <th><span>名称</span></th>
                    <th><span>内网IP</span></th>
                    <th><span>公网IP</span></th>
                    <th><span>状态</span></th>
                    <th><span>镜像</span></th>
                    <th><span>配置</span></th>
                    <th><span>监控</span></th>
                    <th><span>创建时间</span></th>
                    <th><span>VNC登录</span></th>
                </tr>
                </thead>
                <tbody id="tby">
                <tr ng-if="vmList.length>0" ng-repeat="vm in vmList">
                    <td>
                        <span class="iconfont icon-checkiconfill" ng-class="{checked:vm.checked}" ng-click="checkVm(vm)"></span>
                    </td>
                    <td><span>{{vm.name}}</span></td>
                    <td><span>{{vm.ipAddresses.private.join(', ') || '未设置'}}</span></td>
                    <td><span>{{vm.ipAddresses.public.join(', ') || '未设置'}}</span></td>
                    <td>
                        <span>{{vm.status | vmStatusFilter}}</span>
                        <span ng-if="['BUILD','STARTING','STOPING','DELETEING'].indexOf(vm.status)>-1" class="status-loading"></span>
                    </td>
                    <td><span>{{vm.image.name}}</span></td>
                    <td><span>{{vm.flavor | vmFlavorFilter}}</span></td>
                    <td><span class="iconfont icon-monitor"></span></td>
                    <td><span>{{vm.created | date:'yyyy-MM-dd'}}</span></td>
                    <td><span class="iconfont icon-computer"></span></td>
                </tr>
                <tr ng-if="vmList.length==0">
                    <td colspan=10>暂无云主机，去创建吧。</td>
                </tr>
                </tbody>
            </table>
            <pagination ng-if="vmList.length>0" boundary-links="true" direction-links="false" ng-change="onPageChange()" items-per-page="pageSize"
                        total-items="totalItems" ng-model="currentPage" class="pagination-sm" first-text="&laquo;"
                        last-text="&raquo;">
            </pagination>
        </div>

    </div>
    <toaster-container toaster-options="{'time-out': 3000, 'close-button':true,'position-class':'toast-bottom-right'}">
    </toaster-container>
    <script type="text/ng-template" id="VmCreateModalTpl">
            <div class="modal-header letv-modal-header vm-create-modal-header">
                <button type="button" class="close" ng-click="closeModal()" aria-label="Close"><i class="iconfont icon-add"></i></button>
                <h3 class="modal-title">创建云主机</h3>
            </div>
            <div class="modal-body">
                <form novalidate class="vm-create-form" name="vm_create_form">
                <div class="col-sm-8 body-left">
                    <div class="left-flow clearfix">
                        <div class="flow-desc pull-left">
                            <div class="flow-dot-parent">
                                <div class="dot-parent-child"><span>1</span></div>
                            </div>
                            <span>镜像选择</span>
                        </div>
                        <div class="flow-line pull-left" ng-class="{unactive:activeFlow<2}"></div>
                        <div class="flow-desc pull-left" ng-class="{unactive:activeFlow<2}">
                            <div class="flow-dot-parent">
                                <div class="dot-parent-child"><span>2</span></div>
                            </div>
                            <span>配置选择</span>
                        </div>
                        <div class="flow-line pull-left" ng-class="{unactive:activeFlow<3}"></div>
                        <div class="flow-desc pull-left" ng-class="{unactive:activeFlow<3}">
                            <div class="flow-dot-parent">
                                <div class="dot-parent-child"><span>3</span></div>
                            </div>
                            <span>网络设置</span>
                        </div>
                        <div class="flow-line pull-left" ng-class="{unactive:activeFlow<4}"></div>
                        <div class="flow-desc pull-left" ng-class="{unactive:activeFlow<4}">
                            <div class="flow-dot-parent">
                                <div class="dot-parent-child"><span>4</span></div>
                            </div>
                            <span>主机设置</span>
                        </div>
                    </div>
                    <div id="left-flowone" ng-class="{hide:activeFlow!=1}">
                        <div class="left-inputs">
                            <div class="inputs-item clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">主机名称：</span></div>
                                <div class="col-sm-10">
                                    <input type="text" name="vm_name" class="le-form-control" ng-model="vmName" placeholder="请输入云主机名称" text-restrict />
                                    <span ng-show="(vm_create_form.$submitted || vm_create_form.vm_name.$touched) && vm_create_form.vm_name.$error.textRestrict" class="le-input-validation">名称不符合规则</span>
                                </div>
                            </div>
                            <div class="inputs-item clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">镜像：</span></div>
                                <div class="col-sm-10">
                                    <ul class="nav nav-tabs letv-nav-tab" role="tablist">
                                        <li role="presentation" class="active">
                                            <a href="#system" data-toggle="tab" aria-controls="system" class="activea" aria-expanded="true">系统镜像</a>
                                        </li>
                                        <li role="presentation" class="">
                                            <a href="#hostSnap" data-toggle="tab" aria-controls="hostSnap" aria-expanded="false">主机快照</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content letv-tab-content">
                                        <div role="tabpanel" class="tab-pane active" id="system">
                                            <ul class="system-content clearfix">
                                                <li ng-repeat="vmImage in vmImageList">
                                                    <div class="letv-radioCheck" ng-class="{'selected':isSelectedVmImage(vmImage)}" ng-click="selectVmImage(vmImage)">
                                                        <i class="iconfont icon-checkblockicon"></i>
                                                        <span class="letv-radio-content" title="{{vmImage.name}}">{{vmImage.name}}</span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="hostSnap">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="left-button">
                            <div class="col-sm-12">
                                <div class="btn btn-le-blue pull-right" ng-click="$event.preventDefault();activeFlow=2;hackRzSlider();"><span>下一步</span></div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div id="left-flowtwo" ng-class="{hide:activeFlow!=2}">
                        <div class="left-inputs">
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">CPU：</span></div>
                                <div class="col-sm-10">
                                    <div class="letv-mutiCheck check-cpu" ng-repeat="vmCpu in vmCpuList" ng-class="{'selected':isSelectedVmCpu(vmCpu)}" ng-click="selectVmCpu(vmCpu)">
                                        <span>{{vmCpu}}核</span>
                                        <i class="iconfont icon-checkroundfillicon"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">内存：</span></div>
                                <div class="col-sm-10">
                                    <div class="letv-mutiCheck check-ram" ng-repeat="vmRam in vmRamList" ng-class="{'selected':isSelectedVmRam(vmRam)}" ng-click="selectVmRam(vmRam)">
                                        <span>{{vmRam/1024 | number:0}}G</span>
                                        <i class="iconfont icon-checkroundfillicon"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">数据盘：</span></div>
                                <div class="col-sm-10">
                                    <div class="letv-mutiCheck check-disk-type" ng-repeat="vmDiskType in vmDiskTypeList" ng-class="{'selected':isSelectedVmDiskType(vmDiskType)}" ng-click="selectVmDiskType(vmDiskType)">
                                        <span>{{vmDiskType.name}}</span>
                                        <i class="iconfont icon-checkroundfillicon"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-offset-2">
                                    <rzslider rz-slider-model="dataDiskVolume" rz-slider-floor="10" rz-slider-ceil="2048" rz-slider-step="10" rz-slider-always-show-bar="true">
                                    </rzslider>
                                    <span class="disk-volume">{{dataDiskVolume}}</span>
                                    <span class="disk-volume-unit">GB</span>
                                </div>
                            </div>
                            <div class="inputs-item row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">系统盘：</span></div>
                                <div class="col-sm-10"><span class="letv-control-label">默认系统盘 40G</span></div>
                            </div>
                        </div>
                        <div class="left-button">
                            <div class="col-sm-12">
                                <div class="btn btn-le-blue pull-left" ng-click="$event.preventDefault();activeFlow=1"><span>上一步</span></div>
                                <div class="btn btn-le-blue pull-right" ng-click="$event.preventDefault();activeFlow=3;hackRzSlider();"><span>下一步</span></div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div id="left-flowthree" ng-class="{hide:activeFlow!=3}">
                        <div class="left-inputs">
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2">
                                    <span class="letv-control-label">类型：</span>
                                </div>
                                <div class="col-sm-10 radio-check-group">
                                    <div class="letv-radioCheck selected">
                                        <i class="iconfont icon-checkblockicon"></i>
                                        <span class="letv-radio-content">基础网络</span>
                                    </div>
                                    <div class="letv-radioCheck">
                                        <i class="iconfont icon-checkblockicon"></i>
                                        <span class="letv-radio-content">私有网络</span>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">网络：</span></div>
                                <div class="col-sm-10">
                                    <div class="letv-mutiCheck check-network-type" ng-class="{'selected':vmNetworkPublicIpModel=='now'}" ng-click="vmNetworkPublicIpModel='now'">
                                        <span>绑定公网IP</span>
                                        <i class="iconfont icon-checkroundfillicon"></i>
                                    </div>
                                    <div class="letv-mutiCheck check-network-type" ng-class="{'selected':vmNetworkPublicIpModel=='later'}" ng-click="vmNetworkPublicIpModel='later'">
                                        <span>稍后设置</span>
                                        <i class="iconfont icon-checkroundfillicon"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">带宽：</span></div>
                                <div class="col-sm-10">
                                    <rzslider rz-slider-model="networkBandWidth" rz-slider-floor="1" rz-slider-ceil="50" rz-slider-step="1" rz-slider-always-show-bar="true">
                                    </rzslider>
                                    <span class="network-bandwidth">{{networkBandWidth}}</span>
                                    <span class="network-bandwidth-unit">Mbps</span>
                                </div>
                            </div>
                        </div>
                        <div class="left-button">
                            <div class="col-sm-12">
                                <div class="btn btn-le-blue pull-left" ng-click="$event.preventDefault();activeFlow=2;hackRzSlider();"><span>上一步</span></div>
                                <div class="btn btn-le-blue pull-right" ng-click="$event.preventDefault();activeFlow=4"><span>下一步</span></div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div id="left-flowfour" ng-class="{hide:activeFlow!=4}">
                        <div class="left-inputs">
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">登录方式：</span></div>
                                <div class="col-sm-10 radio-check-group">
                                    <div class="letv-radioCheck">
                                        <i class="iconfont icon-checkblockicon"></i>
                                        <span class="letv-radio-content">密钥</span>
                                    </div>
                                    <div class="letv-radioCheck selected">
                                        <i class="iconfont icon-checkblockicon"></i>
                                        <span class="letv-radio-content">密码</span>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">用户名：</span></div>
                                <div class="col-sm-10"><input type="text" class="le-form-control" ng-disabled="true" value="root" /></div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">密码：</span></div>
                                <div class="col-sm-10">
                                    <input type="password" name='password' class="le-form-control" ng-model="vmSecurityPassword" text-restrict />
                                    <span ng-show="(vm_create_form.$submitted || vm_create_form.password.$touched) && vm_create_form.password.$error.textRestrict" class="le-input-validation">密码不符合规则</span>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">购买时长：</span></div>
                                <div class="col-sm-10">
                                    <div class="letv-mutiCheck check-buy-period" ng-repeat="vmBuyPeriod in allVmBuyPeriods" ng-class="{'selected':isSelectedVmBuyPeriod(vmBuyPeriod)}" ng-click="selectVmBuyPeriod(vmBuyPeriod)">
                                        <span>{{vmBuyPeriod | vmBuyPeriodFilter:isSelectedVmBuyPeriod(vmBuyPeriod) }}</span>
                                        <i class="iconfont icon-checkroundfillicon1"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="inputs-item nomargin row clearfix">
                                <div class="col-sm-2"><span class="letv-control-label">购买数量：</span></div>
                                <div class="col-sm-10">
                                    <numeric-input numeric-model="vmCount"></numeric-input>
                                </div>
                            </div>
                        </div>
                        <div class="left-button">
                            <div class="col-sm-12">
                                <div class="btn btn-le-blue pull-left" ng-click="$event.preventDefault();activeFlow=3;hackRzSlider();"><span>上一步</span></div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 body-right">
                    <div class="right-top">
                        <div class="top-title"><span>配置详情</span><i class="iconfont icon-rounddown"></i></div>
                        <ul class="top-items">
                            <li><span class="title">镜像：</span><span class="value">{{selectedVmImage.name}}</span></li>
                            <li><span class="title">CPU：</span><span class="value">{{selectedVmCpu}}核</span></li>
                            <li><span class="title">内存：</span><span class="value">{{selectedVmRam/1024 | number:0}}GB</span></li>
                            <li><span class="title">硬盘：</span><span class="value">{{dataDiskVolume}}GB</span></li>
                            <li><span class="title">主机名：</span><span class="value">{{vmName}}</span></li>
                            <li><span class="title">购买时长：</span><span class="value">{{vmBuyPeriod | vmBuyPeriodFilter:isSelectedVmBuyPeriod(vmBuyPeriod) }}</span></li>
                            <li><span class="title">数量：</span><span class="value">{{vmCount}}台</span></li>
                        </ul>
                    </div>
                    <div class="right-bottom">
                        <span>
                            <span class="title">合计：</span>
                            <span class="price">{{vmTotalPrice}}</span>
                            <span class="unit">元</span>
                        </span>
                        <button class="btn btn-le-red btn-submit-order" ng-click="createVm()"><span>提交订单</span></button>
                    </div>
                </div>
                <div class="clearfix"></div>
                </form>
            </div>
    </script>

    <script type="text/ng-template" id="ConfirmModalTpl">
            <div class="le-confirm">
                <div class="le-row confirm-header">
                    <span class="confirm-title">{{title}}</span>
                    <a class="close" ng-click="closeModal()">
                        <i class="iconfont icon-add"></i>
                    </a>
                </div>
                <div class="le-row confirm-content">
                    <i class="iconfont icon-icon1"></i>
                    <span class="confirm-message">{{confirmMessage}}</span>
                </div>
                <div class="le-row confirm-operation">
                    <button class="btn btn-le-blue" ng-click="ok()">确定</button>
                    <button class="btn btn-le-yellow" ng-click="cancel()">取消</button>
                </div>
            </div>
    </script>
</div>